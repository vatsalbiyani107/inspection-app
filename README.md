USE [JSL_HSM_DB]
GO
/****** Object:  Trigger [dbo].[trg_ForceChemValues]    Script Date: 2/26/2026 11:41:52 AM ******/
SET ANSI_NULLS ON
GO
SET QUOTED_IDENTIFIER ON
GO
ALTER TRIGGER [dbo].[trg_ForceChemValues]
ON [dbo].[SLAB_LMS_DETAILS_PikeStoresData]
AFTER INSERT
AS
BEGIN
    SET NOCOUNT ON;

    UPDATE P
    SET
        P.ANALYSIS_C  = CASE WHEN F.ANALYSIS_C  IS NOT NULL THEN F.ANALYSIS_C  ELSE P.ANALYSIS_C  END,
        P.ANALYSIS_MN = CASE WHEN F.ANALYSIS_MN IS NOT NULL THEN F.ANALYSIS_MN ELSE P.ANALYSIS_MN END,
        P.ANALYSIS_S  = CASE WHEN F.ANALYSIS_S  IS NOT NULL THEN F.ANALYSIS_S  ELSE P.ANALYSIS_S  END,
        P.ANALYSIS_P  = CASE WHEN F.ANALYSIS_P  IS NOT NULL THEN F.ANALYSIS_P  ELSE P.ANALYSIS_P  END,
        P.ANALYSIS_SI = CASE WHEN F.ANALYSIS_SI IS NOT NULL THEN F.ANALYSIS_SI ELSE P.ANALYSIS_SI END,
        P.ANALYSIS_NI = CASE WHEN F.ANALYSIS_NI IS NOT NULL THEN F.ANALYSIS_NI ELSE P.ANALYSIS_NI END,
        P.ANALYSIS_CR = CASE WHEN F.ANALYSIS_CR IS NOT NULL THEN F.ANALYSIS_CR ELSE P.ANALYSIS_CR END,
        P.ANALYSIS_CU = CASE WHEN F.ANALYSIS_CU IS NOT NULL THEN F.ANALYSIS_CU ELSE P.ANALYSIS_CU END,
        P.ANALYSIS_MO = CASE WHEN F.ANALYSIS_MO IS NOT NULL THEN F.ANALYSIS_MO ELSE P.ANALYSIS_MO END,
        P.ANALYSIS_TI = CASE WHEN F.ANALYSIS_TI IS NOT NULL THEN F.ANALYSIS_TI ELSE P.ANALYSIS_TI END,
        P.ANALYSIS_V  = CASE WHEN F.ANALYSIS_V  IS NOT NULL THEN F.ANALYSIS_V  ELSE P.ANALYSIS_V  END,
        P.ANALYSIS_H  = CASE WHEN F.ANALYSIS_H  IS NOT NULL THEN F.ANALYSIS_H  ELSE P.ANALYSIS_H  END,
        P.ANALYSIS_N  = CASE WHEN F.ANALYSIS_N  IS NOT NULL THEN F.ANALYSIS_N  ELSE P.ANALYSIS_N  END,
        P.ANALYSIS_PB = CASE WHEN F.ANALYSIS_PB IS NOT NULL THEN F.ANALYSIS_PB ELSE P.ANALYSIS_PB END,
        P.ANALYSIS_SN = CASE WHEN F.ANALYSIS_SN IS NOT NULL THEN F.ANALYSIS_SN ELSE P.ANALYSIS_SN END,
        P.ANALYSIS_AL = CASE WHEN F.ANALYSIS_AL IS NOT NULL THEN F.ANALYSIS_AL ELSE P.ANALYSIS_AL END,
        P.ANALYSIS_CA = CASE WHEN F.ANALYSIS_CA IS NOT NULL THEN F.ANALYSIS_CA ELSE P.ANALYSIS_CA END,
        P.ANALYSIS_B  = CASE WHEN F.ANALYSIS_B  IS NOT NULL THEN F.ANALYSIS_B  ELSE P.ANALYSIS_B  END,
        P.ANALYSIS_CO = CASE WHEN F.ANALYSIS_CO IS NOT NULL THEN F.ANALYSIS_CO ELSE P.ANALYSIS_CO END,
        P.ANALYSIS_NB = CASE WHEN F.ANALYSIS_NB IS NOT NULL THEN F.ANALYSIS_NB ELSE P.ANALYSIS_NB END
    FROM [dbo].[SLAB_LMS_DETAILS_PikeStoresData] P
    INNER JOIN INSERTED I ON P.SlabID = I.SlabID
    INNER JOIN Forced_Value_Chem F ON F.GRADE = I.STEELGRADE AND F.Active = 1

END
